<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="733" height="447"><defs/><g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="591" y="97" width="319" height="87" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="666" y="79" width="253" height="22" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="584" y="90" width="319" height="87"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 584 90 L 903 90 L 903 177 L 584 177 L 584 90 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 584 130 L 903 130" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 584 140 L 903 140" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="italic" font-weight="bold" text-decoration="none" x="704" y="109.5">QueryPlanner</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="700.5" y="124.5">(from planning)</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="589" y="157.5">+strategies(): Seq[GenericStrategy[PhysicalPlan]]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="589" y="172.5">+plan(plan: LogicalPlan): Iterator[PhysicalPlan]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="659" y="72" width="253" height="22"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 659 72 L 912 72 L 912 94 L 659 94 L 659 72 Z Z" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="664" y="89.5">[PhysicalPlan &lt;: TreeNode[PhysicalPlan]]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="207" y="97" width="290" height="87" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="261" y="79" width="245" height="22" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="200" y="90" width="290" height="87"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 200 90 L 490 90 L 490 177 L 200 177 L 200 90 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 200 130 L 490 130" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 200 140 L 490 140" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="italic" font-weight="bold" text-decoration="none" x="298" y="109.5">GenericStrategy</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="302" y="124.5">(from planning)</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="205" y="157.5">+planLater(plan: LogicalPlan): PhysicalPlan</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="205" y="172.5">+apply(plan: LogicalPlan): Seq[PhysicalPlan]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="254" y="72" width="245" height="22"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 254 72 L 499 72 L 499 94 L 254 94 L 254 72 Z Z" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="259" y="89.5">PhysicalPlan &lt;: TreeNode[PhysicalPlan]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="767" y="271" width="107" height="44" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="760" y="264" width="107" height="44"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 760 264 L 867 264 L 867 308 L 760 308 L 760 264 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 760 289 L 867 289" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 760 299 L 867 299" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="italic" font-weight="bold" text-decoration="none" x="767" y="283.5">SparkStrategies</text></g></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 812 264 L 812 177" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="#FFFFFF" stroke="none" d="M 820.419035512032 197.3253497152483 L 812 177 L 803.580964487968 197.3253497152483"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 820.419035512032 197.3253497152483 L 812 177 L 803.580964487968 197.3253497152483 L 820.419035512032 197.3253497152483" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="720" y="226">+QueryPlanner[SparkPlan]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="215" y="361" width="236" height="145" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="244" y="343" width="216" height="22" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="208" y="354" width="236" height="145"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 208 354 L 444 354 L 444 499 L 208 499 L 208 354 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 208 394 L 444 394" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 208 417 L 444 417" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="italic" font-weight="bold" text-decoration="none" x="295.5" y="373.5">QueryPlan</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="291.5" y="388.5">(from plans)</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="213" y="411.5">+schema: StructType</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="213" y="434.5">+outputSet(): AttributeSet</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="213" y="449.5">+inputSet(): AttributeSet</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="213" y="464.5">+constraints(): ExpressionSet</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="213" y="479.5">+references(): AttributeSet</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="213" y="494.5">+expressions(): Seq[Expression]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="237" y="336" width="216" height="22"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 237 336 L 453 336 L 453 358 L 237 358 L 237 336 Z Z" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="242" y="353.5">[PlanType &lt;: QueryPlan[PlanType]]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="527" y="431" width="182" height="70" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="520" y="424" width="182" height="70"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 520 424 L 702 424 L 702 494 L 520 494 L 520 424 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 520 449 L 702 449" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 520 472 L 702 472" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="italic" font-weight="bold" text-decoration="none" x="581" y="443.5">SparkPlan</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="466.5">+sqlContext</text></g></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="525" y="489.5">+execute(): RDD[InternalRow]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 520 459 L 454 459" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="#FFFFFF" stroke="none" d="M 474.3253497152483 450.580964487968 L 454 459 L 474.3253497152483 467.419035512032"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 474.3253497152483 450.580964487968 L 454 459 L 474.3253497152483 467.419035512032 L 474.3253497152483 450.580964487968" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="303" y="263" width="96" height="44" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="296" y="256" width="96" height="44"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 296 256 L 392 256 L 392 300 L 296 300 L 296 256 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 296 281 L 392 281" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 296 291 L 392 291" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="italic" font-weight="bold" text-decoration="none" x="302.5" y="275.5">SparkStrategy</text></g></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 345 256 L 345 177" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="#FFFFFF" stroke="none" d="M 353.419035512032 197.3253497152483 L 345 177 L 336.580964487968 197.3253497152483"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 353.419035512032 197.3253497152483 L 345 177 L 336.580964487968 197.3253497152483 L 353.419035512032 197.3253497152483" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="245" y="222">+GenericStrategy[SparkPlan]</text></g></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="775" y="375" width="93" height="44" opacity="0.2"/></g><g transform="translate(-190,-62) scale(1,1)"><rect fill="#ffffff" stroke="none" x="768" y="368" width="93" height="44"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 768 368 L 861 368 L 861 412 L 768 412 L 768 368 Z Z" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 768 393 L 861 393" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 768 403 L 861 403" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="775.5" y="387.5">SparkPlanner</text></g></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 816 368 L 816 308" stroke-miterlimit="10"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="#FFFFFF" stroke="none" d="M 824.419035512032 328.3253497152483 L 816 308 L 807.580964487968 328.3253497152483"/></g><g transform="translate(-190,-62) scale(1,1)"><path fill="none" stroke="#000000" d="M 824.419035512032 328.3253497152483 L 816 308 L 807.580964487968 328.3253497152483 L 824.419035512032 328.3253497152483" stroke-miterlimit="10"/></g></g></svg>